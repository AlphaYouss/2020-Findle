@{
    ViewData["Title"] = "Personal Details";
}

@{
    Layout = "_FindleLayout";
}


@model ASP.NETFindle.Models.User;

<h1>Your Personal Details</h1>

@{
    var currentUser = ViewData["currentUser"] as ASP.NETFindle.Models.User;
}

@Html.ValidationMessage("password", "", new { @class = "text-danger" })

<div>
    <div class="mt-2">
        <h4>Full name</h4>
        <span>@currentUser.Firstname @currentUser.Lastname</span>
    </div>
    <div class="mt-2">
        <h4>Email</h4>
        <span>@currentUser.Email</span>
    </div>
    <div class="mt-2">
        <h4>Type</h4>
        <span>@currentUser.UserFunction</span>
    </div>
    <div class="mt-2">
        <h4>Profile</h4>
        <span>@currentUser.Profile</span>
    </div>
    <div class="mt-2">
        <h4>Status</h4>
        <span>
            @{
                if (@currentUser.Findable == true)
                {
                    <text>You're searchable.</text>
                }
                else
                {
                    <text>You're not searchable.</text>
                }
            }
        </span>
    </div>
    <div class="mt-2">
        <h4>Password</h4>
        <div id="partialPassword" class="mt-3">

        </div>
        <button id="submit" class="btn btn-outline-primary">Change password</button>
    </div>
    <h4 class="mt-3">Search histories</h4>
    <div id="history"></div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

    <script>
    var url = '@Url.Action("GetChangePassword", "User")';

    $('#submit').on('click',function(e){
         e.preventDefault();
        $.ajax({
            type: "POST",
            url: url,
            data:$('form').serialize(),
        }).done(function (r) {
            $('#submit').hide();
           $('#partialPassword').html(r);

        }).fail(function (e) {
            console.log(e.responseText);
        });
    });

    $('#history').load('@Url.Action("GetHistories","User")');
    </script>
